<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Î¨∏Ïû• Í≤ÄÏó¥ & Î≥µÏõê Í¥ÄÎ¶¨Ïûê ÌéòÏù¥ÏßÄ (React)</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
        margin: 0;
        background-color: #f7f7f7;
      }
      .header {
        display: flex;
        justify-content: flex-end;
        margin-bottom: 1rem;
      }
      .save-button {
        padding: 0.5rem 1rem;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
      }
      .panel {
        background-color: white;
        padding: 1.5rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
        width: 90%;
        max-width: 700px;
        margin: 0 auto;
      }
      .display-text {
        white-space: pre-wrap;
        line-height: 1.6;
        color: black;
      }
      .censored {
        position: relative;
        background: linear-gradient(to right, #6dadff, #fe86d7);
        background-clip: text;
        -webkit-background-clip: text;
        color: transparent;
        font-weight: bold;
        cursor: pointer;
        transition: filter 0.2s ease;
      }
      .censored:hover {
        filter: brightness(1.2);
      }
      #censor-btn {
        position: absolute;
        z-index: 1000;
        display: none;
        padding: 6px 10px;
        background: linear-gradient(to right, #6dadff, #fe86d7);
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: bold;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        transition: transform 0.1s ease-in-out;
      }
      #censor-btn:hover {
        transform: scale(1.3);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script
      src="https://unpkg.com/react@18/umd/react.development.js"
      crossorigin
    ></script>
    <script
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
      crossorigin
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      const originalText = `‚ÄúÏïàÎÖï!‚Äù ÌïòÍ≥† Í∑∏Îäî Ïô∏Ï≥§Îã§. ‚ÄúÏò§ÎäòÏùÄ Ï†ïÎßê Í∏∞Î∂ÑÏù¥ Ï¢ãÏïÑ.‚Äù
ÎÇ†Ïî®Îäî ÎßëÍ≥†, ÏÉàÎì§ÏùÄ ÎÖ∏ÎûòÌñàÏúºÎ©∞‚Ä¶ Î∞îÎûåÎèÑ Î∂ÄÎìúÎü¨Ïõ†Îã§.
(ÏÇ¨Ïã§, Ïù¥Îü∞ ÎÇ†Ïî®Îäî ÌùîÏπò ÏïäÎã§!)
Í∑∏Îäî ‚ÄòÌñâÎ≥µ‚ÄôÏùÑ ÎäêÍºàÍ≥† - Ïù¥Ïú†Îäî Îã®ÏàúÌñàÎã§: ÌñáÏÇ¥Ïù¥ Ï¢ãÏïòÍ∏∞ ÎïåÎ¨∏Ïù¥Îã§.
‚ÄúÎÑàÎèÑ ÎäêÍª¥ÏßÄÏßÄ ÏïäÏïÑ?‚Äù ÎùºÎ©∞, Í∑∏Îäî ÎÇòÎ•º Î∞îÎùºÎ≥¥ÏïòÎã§.
ÎÇòÎäî Í≥†Í∞úÎ•º ÎÅÑÎçïÏù¥Î©∞, ‚ÄòÏùë!‚Äô ÌïòÍ≥† ÎãµÌñàÎã§.
Í∑∏Îïå [ÏûëÏùÄ Í≥†ÏñëÏù¥] Ìïú ÎßàÎ¶¨Í∞Ä Îã§Í∞ÄÏôîÍ≥†‚ÄïÏö∞Î¶¨ ÏòÜÏóê ÏÇ¥Ìè¨Ïãú ÏïâÏïòÎã§.
Ï†ïÏ†Å‚Ä¶ Í∑∏Îü¨ÎÇò Îî∞ÎúªÌïú, ÌèâÌôîÎ°úÏö¥ ÏãúÍ∞ÑÏù¥ÏóàÎã§.
‚ÄúÏù¥Îü∞ ÏàúÍ∞ÑÏù¥ ¬∑ ÏÇ∂Ïùò ÏßÑÏßú ÏùòÎØ∏ ÏïÑÎãêÍπå?‚Äù
Í∑∏Îäî ÏõÉÏúºÎ©∞, ÎÇòÏßÄÎßâÏù¥ ÎßêÌñàÎã§: ‚ÄúÎßûÏïÑ. Ï†ïÎßê Í∑∏Îûò.‚Äù

üá∫üá∏ ÏòÅÏñ¥ Î≤àÏó≠
"Hello!" he shouted. "I feel really good today."
The weather was clear, the birds were singing‚Ä¶ and the wind was gentle.
(Actually, such weather is rare!)
He felt ‚Äòhappiness‚Äô‚Äîfor a simple reason: because the sunshine was beautiful.
"Don‚Äôt you feel it too?" he asked, looking at me.
I nodded and replied, "Yeah!"
Then, a [little cat] approached and‚Äïgently sat beside us.
Silence‚Ä¶ but it was a warm, peaceful moment.
"Isn‚Äôt this kind of moment ¬∑ the true meaning of life?"
He smiled and whispered, "Yes. It really is."

üáØüáµ ÏùºÎ≥∏Ïñ¥ Î≤àÏó≠
„Äå„Åì„Çì„Å´„Å°„ÅØÔºÅ„Äç„Å®ÂΩº„ÅØÂè´„Çì„Å†„ÄÇ„Äå‰ªäÊó•„ÅØÊú¨ÂΩì„Å´Ê∞óÂàÜ„Åå„ÅÑ„ÅÑ„ÄÇ„Äç
Â§©Ê∞ó„ÅØÊô¥„Çå„Å¶„ÅÑ„Å¶„ÄÅÈ≥•„Åü„Å°„ÅØ„Åï„Åà„Åö„Çä‚Ä¶È¢®„ÇÇ„ÇÑ„Åï„Åó„Åã„Å£„Åü„ÄÇ
ÔºàÂÆü„ÅØ„ÄÅ„Åì„Çì„Å™Â§©Ê∞ó„ÅØÁèç„Åó„ÅÑÔºÅÔºâ
ÂΩº„ÅØ„ÄéÂπ∏„Åõ„Äè„ÇíÊÑü„Åò„Å¶„ÅÑ„Åü‚Äî„Åù„ÅÆÁêÜÁî±„ÅØÂçòÁ¥î„Å†„Å£„ÅüÔºöÊó•Â∑Æ„Åó„ÅåÂøÉÂú∞„Çà„Åã„Å£„Åü„Åã„Çâ„Å†„ÄÇ
„ÄåÂêõ„ÇÇÊÑü„Åò„Å™„ÅÑÔºü„Äç„Å®ÂΩº„ÅØÁßÅ„ÇíË¶ã„Å§„ÇÅ„Åü„ÄÇ
ÁßÅ„ÅØ„ÅÜ„Å™„Åö„ÅÑ„Å¶„ÄÅ„Äå„ÅÜ„ÇìÔºÅ„Äç„Å®Á≠î„Åà„Åü„ÄÇ
„Åù„ÅÆÊôÇ„ÄÅ[Â∞è„Åï„Å™Áå´]„ÅåËøë„Å•„ÅÑ„Å¶„Åç„Å¶‚ÄïÁßÅ„Åü„Å°„ÅÆ„Åù„Å∞„Å´„Åù„Å£„Å®Â∫ß„Å£„Åü„ÄÇ
ÈùôÂØÇ‚Ä¶„Åß„ÇÇÊ∏©„Åã„Åè„Å¶„ÄÅÂπ≥Âíå„Å™ÊôÇÈñì„Å†„Å£„Åü„ÄÇ
„Äå„Åì„ÅÜ„ÅÑ„ÅÜÁû¨Èñì„Åì„Åù ¬∑ ‰∫∫Áîü„ÅÆÊú¨ÂΩì„ÅÆÊÑèÂë≥„Åò„ÇÉ„Å™„ÅÑÔºü„Äç
ÂΩº„ÅØÁ¨ë„ÅÑ„Å™„Åå„Çâ„ÄÅ„Åù„Å£„Å®Ë®Ä„Å£„ÅüÔºö„Äå„ÅÜ„Çì„ÄÇÊú¨ÂΩì„Å´„Åù„ÅÜ„Å†„ÄÇ„Äç

üá®üá≥ Ï§ëÍµ≠Ïñ¥ Î≤àÏó≠
‚Äú‰Ω†Â•ΩÔºÅ‚Äù‰ªñÂñäÈÅì„ÄÇ‚Äú‰ªäÂ§©ÂøÉÊÉÖÁúüÂ•Ω„ÄÇ‚Äù
Â§©Ê∞îÊô¥ÊúóÔºåÈ∏üÂÑøÂú®Ê≠åÂî±‚Ä¶‚Ä¶È£é‰πüÂæàÊ∏©Êüî„ÄÇ
ÔºàÂÖ∂ÂÆûÔºåËøôÊ†∑ÁöÑÂ§©Ê∞îÂπ∂‰∏çÂ∏∏ËßÅÔºÅÔºâ
‰ªñÊÑüÂà∞‚ÄúÂπ∏Á¶è‚Äù‚Äî‚ÄîÂéüÂõ†ÂæàÁÆÄÂçïÔºöÈò≥ÂÖâÂæàÂ•Ω„ÄÇ
‚Äú‰Ω†‰πüÊúâËøôÁßçÊÑüËßâÂêóÔºü‚Äù‰ªñËØ¥ÁùÄÔºåÁúãÁùÄÊàë„ÄÇ
ÊàëÁÇπ‰∫ÜÁÇπÂ§¥ÔºåÂõûÁ≠îÔºö‚ÄúÂóØÔºÅ‚Äù
ËøôÊó∂Ôºå‰∏ÄÂè™[Â∞èÁå´]Ëµ∞ËøáÊù•‚Äï‚ÄïÈùôÈùôÂú∞ÂùêÂú®Êàë‰ª¨ÊóÅËæπ„ÄÇ
ÂØÇÈùô‚Ä¶‚Ä¶‰ΩÜÈÇ£ÊòØÊ∏©ÊöñËÄåÂπ≥ÂíåÁöÑÊó∂Âàª„ÄÇ
‚ÄúËøôÊ†∑ÁöÑÊó∂Âàª ¬∑ ÈöæÈÅì‰∏çÊòØ‰∫∫ÁîüÁúüÊ≠£ÁöÑÊÑè‰πâÂêóÔºü‚Äù
‰ªñÁ¨ëÁùÄ‰ΩéÂ£∞ËØ¥Ôºö‚ÄúÊòØÁöÑÔºåÁúüÁöÑÂ¶ÇÊ≠§„ÄÇ‚Äù`;

      function mergeRanges(ranges) {
        if (!ranges.length) return [];
        const sorted = [...ranges].sort((a, b) => a.start - b.start);
        const merged = [sorted[0]];
        for (let i = 1; i < sorted.length; i++) {
          const prev = merged[merged.length - 1];
          const curr = sorted[i];
          if (curr.start <= prev.end) {
            prev.end = Math.max(prev.end, curr.end);
          } else {
            merged.push(curr);
          }
        }
        return merged;
      }

      function App() {
        const [censoredRanges, setCensoredRanges] = useState([]);
        const [selectionRange, setSelectionRange] = useState(null);
        const containerRef = useRef(null);

        const getCharOffset = (container, node, offset) => {
          let charCount = 0;
          const walker = document.createTreeWalker(
            container,
            NodeFilter.SHOW_TEXT
          );
          while (walker.nextNode()) {
            const currentNode = walker.currentNode;

            if (
              currentNode.parentElement &&
              currentNode.parentElement.classList.contains("tooltip")
            ) {
              continue;
            }

            if (currentNode === node) return charCount + offset;
            charCount += currentNode.textContent.length;
          }
          return null;
        };

        const handleMouseUp = () => {
          const sel = window.getSelection();
          if (sel && sel.toString().trim()) {
            const range = sel.getRangeAt(0);
            const startOffset = getCharOffset(
              containerRef.current,
              range.startContainer,
              range.startOffset
            );
            const endOffset = getCharOffset(
              containerRef.current,
              range.endContainer,
              range.endOffset
            );
            if (
              startOffset != null &&
              endOffset != null &&
              endOffset > startOffset
            ) {
              const rect = range.getBoundingClientRect();
              setSelectionRange({
                start: startOffset,
                end: endOffset,
                text: originalText.slice(startOffset, endOffset),
                top: rect.top + window.scrollY - 36,
                left: rect.right + window.scrollX + 8,
              });
            }
          } else {
            setSelectionRange(null);
          }
        };

        const handleCensor = () => {
          if (selectionRange) {
            setCensoredRanges((prev) => mergeRanges([...prev, selectionRange]));
            setSelectionRange(null);
            window.getSelection().removeAllRanges();
          }
        };

        useEffect(() => {
          document.addEventListener("mouseup", handleMouseUp);
          return () => document.removeEventListener("mouseup", handleMouseUp);
        }, []);

        const content = [];
        const sortedRanges = mergeRanges(censoredRanges);
        let lastIndex = 0;

        sortedRanges.forEach(({ start, end }, i) => {
          if (start > lastIndex) {
            content.push(
              <span key={`normal-${i}`}>
                {originalText.slice(lastIndex, start)}
              </span>
            );
          }
          content.push(
            <span
              key={`censored-${i}`}
              className="censored"
              onClick={() => {
                const updated = [...censoredRanges];
                updated.splice(i, 1);
                setCensoredRanges(updated);
              }}
            >
              {originalText.slice(start, end)}
            </span>
          );
          lastIndex = end;
        });

        if (lastIndex < originalText.length) {
          content.push(<span key="tail">{originalText.slice(lastIndex)}</span>);
        }

        return (
          <div className="app">
            <div className="header">
              <button
                className="save-button"
                onClick={() => {
                  const sortedRanges = [...censoredRanges].sort(
                    (a, b) => b.start - a.start
                  );
                  let finalText = originalText;

                  sortedRanges.forEach(({ start, end }) => {
                    finalText =
                      finalText.slice(0, start) +
                      "[ Í≤ÄÏó¥Îê® ]" +
                      finalText.slice(end);
                  });

                  const payload = {
                    finalText,
                  };

                  const blob = new Blob([JSON.stringify(payload, null, 2)], {
                    type: "application/json",
                  });
                  const url = URL.createObjectURL(blob);
                  const a = document.createElement("a");
                  a.href = url;
                  a.download = "censored_result.json";
                  document.body.appendChild(a);
                  a.click();
                  document.body.removeChild(a);
                  URL.revokeObjectURL(url);
                }}
              >
                Ï†ÄÏû•
              </button>
            </div>
            <div className="panel">
              <h2>‚úçÔ∏è ÏàòÏ†ï Ï§ëÏù∏ Í∏Ä</h2>
              <div className="display-text" ref={containerRef}>
                {content}
              </div>
            </div>
            {selectionRange && (
              <button
                id="censor-btn"
                style={{
                  top: selectionRange.top,
                  left: selectionRange.left,
                  display: "block",
                  position: "absolute",
                }}
                onClick={handleCensor}
              >
                Í≤ÄÏó¥
              </button>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
